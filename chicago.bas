10 IF PEEK(&9500)=0 THEN MEMORY &5000-1:LOAD"!CHICAGO.BIN":LOAD"!CHICAGO2.BIN":LOAD"!CHICAGO3.BIN":LOAD"!CHICAGO4.BIN":POKE &9500,1
20 FOR A=&8600 TO &8600+20:POKE A,240:NEXT:HI=10001
30 '* COLORS ***********
40 DATA 15,24,3,6,15,0,11,1,23,26,12,18,19,9,4,13
50 RESTORE 40:FOR A=0 TO 15:READ K:INK A,K:NEXT
60 INK 14,0,24:SPEED INK 5,5
70 '* INIT *************
80 DIM LE(25):FOR A=0 TO 20:LE(A)=&5F10+A*16:NEXT:LE(21)=&6050:FOR A=22 TO 25:LE(A)=&5F00+A*16:NEXT:FOR A=0 TO 9:CH(A)=&60A0+A*16:NEXT
90 GOSUB 1680
100 BORDER 0:MODE 0:PAPER 0:WINDOW #1,1,20,1,3:PAPER#1,5:CLS#1:NIV=1:T=1:SC=100:MUN=160:EN=300:WINDOW #2,1,20,4,25:PAPER#2,0:CLS#2
110 C=1:TI=0:X=38:Y=80:POKE &A008,16:POKE &A00C,4:POKE &A023,16:POKE &A027,4:POKE &A052,16:POKE &A056,4
120 '* DISPLAY *********
130 A$=" SCORE HISCORE STAGE AMMO":XL=1:YL=1:GOSUB 1400:CH=SC:XL=5:YL=9:L=5:GOSUB 1440:CH=HI:XL=21:YL=9:L=7:GOSUB 1440:CH=NIV:XL=41:YL=9:L=5:GOSUB 1440:CH=MUN:XL=57:YL=9:L=9:GOSUB 1440
140 C=1:CLS#2:IF T=6 THEN NIV=2:GOSUB 1560:EN=300 ELSE IF T=1 THEN NIV=1:GOSUB 1560:EN=300 ELSE IF T=11 THEN NIV=3:GOSUB 1560:EN=300 ELSE IF T=21 THEN NIV=5:GOSUB 1560:GOTO 140
150 A$="POWER":XL=26:YL=17:GOSUB 1400:GOSUB 1470
160 IF NIV=1 THEN K=1:W=1 ELSE IF NIV=2 THEN K=1:W=6 ELSE IF NIV=3 THEN K=11:W=11 ELSE IF NIV=4 THEN K=14:W=14
170 IF NIV=1 THEN IF T<>4 THEN IF T<>5 THEN INK 0,1:POKE &902B,16:POKE &9030,4:FOR B=25 TO 185 STEP 16:FOR A=1 TO 77 STEP 4:CALL &9061,A,B,&5000:NEXT:NEXT:FOR A=1 TO 77 STEP 4:CALL &9061,A,25,&5100:NEXT
180 IF NIV=2 THEN IF T<>9 THEN IF T<>10 THEN INK 0,1
190 IF NIV=3 THEN IF T<>14 THEN IF T<>15 THEN INK 0,14:FOR A=352 TO 320 STEP -2:MOVE 0,A:DRAW 640,A,7:NEXT
200 IF NIV=4 THEN IF T<>19 THEN IF T<>20 THEN INK 0,14:FOR A=352 TO 320 STEP -2:MOVE 0,A:DRAW 640,A,7:NEXT
210 IF T=1 THEN GOSUB 410:GOTO 1020
220 IF T=2 THEN GOSUB 450:GOTO 1020
230 IF T=3 THEN GOSUB 480:GOTO 1020
240 IF T=4 THEN GOSUB 530:POKE &9096,112:POKE &90A1,79:POKE &9098,&30:POKE &9099,&C2:GOTO 1140
250 IF T=5 THEN GOSUB 560:GOTO 1260
260 IF T=6 THEN GOSUB 590:GOTO 1020
270 IF T=7 THEN GOSUB 620:GOTO 1020
280 IF T=8 THEN GOSUB 650:GOTO 1020
290 IF T=9 THEN GOSUB 680:POKE &9096,112:POKE &90A1,79:POKE &9098,&30:POKE &9099,&C2:GOTO 1140
300 IF T=10 THEN GOSUB 710:GOTO 1260
310 IF T=11 THEN GOSUB 740:GOTO 1020
320 IF T=12 THEN GOSUB 770:GOTO 1020
330 IF T=13 THEN GOSUB 800:GOTO 1020
340 IF T=14 THEN GOSUB 820:POKE &9096,80:POKE &90A1,79:POKE &9098,&70:POKE &9099,&C3:GOTO 1140
350 IF T=15 THEN GOSUB 850:GOTO 1260
360 IF T=16 THEN GOSUB 880:GOTO 1020
370 IF T=17 THEN GOSUB 910:GOTO 1020
380 IF T=18 THEN GOSUB 940:GOTO 1020
390 IF T=19 THEN GOSUB 970:POKE &9096,80:POKE &90A1,79:POKE &9098,&70:POKE &9099,&C3:GOTO 1140
400 IF T=20 THEN GOSUB 1000:GOTO 1260
410 POKE &902B,32:POKE &9030,8:CALL &9061,9,57,&8000:CALL &9061,35,57,&8000:CALL &9061,65,57,&8000:CALL &9061,9,145,&8000:CALL &9061,35,145,&8000:CALL &9061,63,167,&51C0
420 POKE &902B,16:POKE &9030,4:FOR A=1 TO 77 STEP 4:CALL &9061,A,113,&5100:NEXT
430 X(1)=9:Y(1)=89:H(1)=1:X(4)=35:Y(4)=89:H(4)=1:X(3)=65:Y(3)=89:H(3)=1:X(5)=177:H(5)=1:X(2)=35:Y(2)=177:H(2)=1:CC=5
440 RETURN
450 POKE &902B,16:POKE &9030,4:FOR A=41 TO 105 STEP 16:CALL &9061,1,A,&5040:NEXT:FOR A=129 TO 192 STEP 16:CALL &9061,77,A,&5040:NEXT:FOR A=1 TO 77 STEP 4:CALL &9061,A,113,&5080:NEXT:CALL &9061,1,113,&50C0:CALL &9061,77,1,13,&50C0
460 POKE &902B,32:POKE &9030,8:CALL &9061,9,57,&8000:CALL &9061,65,57,&8000:CALL &9061,15,145,&8000:CALL &9061,65,145,&8000:POKE &902B,16:CALL &9061,35,62,&5140:CALL &9061,35,78,&5140:CALL &9061,30,155,&5140
470 X(1)=9:Y(1)=89:H(1)=1:X(2)=65:Y(2)=89:H(2)=1:X(3)=15:Y(3)=177:H(3)=1:X(4)=65:Y(4)=177:H(4)=1:CC=4:RETURN
480 POKE &902B,16:POKE &9030,4:FOR A=129 TO 192 STEP 16:CALL &9061,1,A,&5040:NEXT:FOR A=129 TO 192 STEP 16:CALL &9061,77,A,&5040:NEXT:FOR A=1 TO 77 STEP 4:CALL &9061,A,113,&5080:NEXT:CALL &9061,1,113,&50C0:CALL &9061,77,113,&50C0
490 POKE &902B,32:POKE &9030,8:CALL &9061,9,57,&8000:CALL &9061,35,57,&8000:CALL &9061,65,57,&8000:CALL &9061,9,145,&8000:CALL &9061,35,145,&8000:CALL &9061,65,145,&8000
500 POKE &902B,16:POKE &9030,4:FOR A=1 TO 30 STEP 4:CALL &9061,A,41,&5100:NEXT:FOR A=49 TO 77 STEP4:CALL &9061,A,41,&5100:NEXT
510 X(1)=9:Y(1)=89:H(1)=1:X(4)=35:Y(4)=89:H(4)=1:X(3)=65:Y(3)=89:H(3)=1:X(5)=9:Y(5)=177:H(5)=1:X(2)=35:Y(2)=177:H(2)=1:X(6)=65:Y(6)=177:H(6)=1:CC=6
520 RETURN
530 INK 0,1:POKE &902B,16:POKE &9030,4:FOR B=57 TO 153 STEP 16:FOR A=1 TO 77 STEP 4:CALL &9061,A,B,&5000:NEXT:NEXT:FOR A=1 TO 77 STEP 4:CALL &9061,A,57,&5100:NEXT:POKE &902B,32:POKE &9030,8
540 CALL &9061,3,137,&51C0:POKE &902B,16:CALL &9061,30,101,&5140:CALL &9061,30,117,&5140:CALL &9061,65,101,&5140:CALL &9061,65,117,&5140:POKE &9030,4:FOR A=73 TO 153 STEP 16:CALL &9061,45,A,&5040:NEXT
550 X(1)=3:Y(1)=25:D(1)=1:X(2)=70:Y(2)=169:D(2)=-1:CC=2:RETURN
560 INK 0,1:POKE &902B,16:POKE &9030,4:FOR B=57 TO 153 STEP 16:FOR A=1 TO 77 STEP 4:CALL &9061,A,B,&5000:NEXT:NEXT:FOR A=1 TO 77 STEP 4:CALL &9061,A,57,&5100:NEXT:POKE &902B,32:POKE &9030,8
570 CALL &9061,3,137,&51C0:POKE &902B,16:CALL &9061,30,101,&5140:CALL &9061,30,117,&5140:CALL &9061,65,101,&5140:CALL &9061,65,117,&5140:POKE &9030,4:FOR A=73 TO 153 STEP 16:CALL &9061,45,A,&5040:NEXT
580 X(1)=36:Y(1)=25:D(C)=-1:CC=2:RETURN
590 POKE &902B,32:POKE &9030,8:FOR A=1 TO 73 STEP 8:CALL &9061,A,100,&5350:NEXT:POKE &902B,16:POKE &9030,4:CALL &9061,20,25,&5590:CALL &9061,56,25,&5590
600 X(1)=9:Y(1)=99:H(1)=1:X(4)=35:Y(4)=99:H(4)=1:X(3)=65:Y(3)=99:H(3)=1:X(5)=20:Y(5)=199:H(5)=1:X(2)=55:Y(2)=199:H(2)=1:CC=5
610 RETURN
